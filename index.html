<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta http-equiv="X-UA-Compatible" content="ie=edge" />
    <title>Rock, Paper, Scissors Game</title>
  </head>
  <body>
    <script>
      // Function to pick Computer's selection
      function computerPlay() {
        let selection = ["rock", "paper", "scissors"];
        let result = selection[Math.floor(Math.random() * selection.length)];
        return result;
      }

      // Function to pick Player's selection
      function playerPlay() {
        let validSelections = ["rock", "paper", "scissors"];
        let selection = prompt("Type Rock, Paper, or Scissors: ").toLowerCase();
        // Validate Player's selection
        if(!validSelections.includes(selection)){
          console.log("Invalid Selection!")
          alert("Please type a valid selection!");
          return playerPlay();
        }
        return selection;
      }

      // Function to play one game round
      function playRound(playerSelection, computerSelection) {
        let result;

        // Determine round outcome
        if(playerSelection === computerSelection){
          return result = "tie"
        } else if (playerSelection === "rock") {
          if(computerSelection == "scissors"){
            return result = "cpu"
          } else {
            return result = "p1"
          }
        } else if (playerSelection === "paper") {
          if(computerSelection == "rock"){
            return result = "cpu"
          } else {
            return result = "p1"
          }
        } else if (playerSelection === "scissors") {
          if(computerSelection == "paper"){
            return result = "cpu"
          } else {
            return result = "p1"
          }
        }
      }

      // Main game function
      function game(){
        let p1_score = 0 // Player's score
        let cpu_score = 0 // Computer's score
        let draws = 0 // Number of tie games
        let rounds = 5 // Number rounds

        // Loop to play multiple rounds
        for(let i = 1; i <= rounds;i++){
          let playerSelection = playerPlay() // Player selections
          let computerSelection = computerPlay() // Computer selection
          let round_result = playRound(playerSelection, computerSelection)
          // Play round
          round_result

          console.log("Round: " + i)

          if(round_result === "p1"){
            console.log(playerSelection + " beats " + computerSelection + ", Player Wins Round!")
            p1_score += 1
          } else if (round_result === "cpu") {
            console.log(computerSelection + " beats " + playerSelection + ", CPU Wins Round!")
            cpu_score += 1
          } else {
            console.log(computerSelection + " vs " + playerSelection + ", Tie Round!")
            draws += 1
          }

          console.log("Your Score: " + p1_score + " | Computer: " + cpu_score + " (Draws: "+ draws +")")
          console.log("****************************")

        }

        // Determine outcome of the game
        if(p1_score > cpu_score){
          return "Player One beat the Computer " + p1_score + " to " + cpu_score + "!"
        } else if (cpu_score > p1_score) {
          return "The Computer beat Player One " + cpu_score + " to " + p1_score + "!"
        } else {
          return "The game ended in a tie, Player One: " + p1_score + " to " + "Computer: " + p1_score + "."
        }
      };

      // Auto start the game
      console.log(game());
    </script>
  </body>
</html>
